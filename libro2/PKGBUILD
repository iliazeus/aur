# Maintainer: Ilia Pozdnyakov <ilia.pozdnyakov@ya.ru>
pkgname="libro2"
pkgver="2.5.1"
pkgrel="1"
pkgdesc="GUI tool for organizing fb2 and epub files"
arch=("any")
url="https://github.com/dnkorpushov/libro2"
license=("GPL-3.0-only")
depends=("python" "python-pyqt5")
optdepends=("fb2converter: convert fb2 files to epub, kepub, mobi and awz3")
makedepends=("python-pex")
conflicts=()
source=(
  "$pkgname-$pkgver.zip"::"https://github.com/dnkorpushov/libro2/archive/refs/tags/v$pkgver.zip"
  "libro2.desktop"
)
md5sums=(
  "31347ff7e3369e7ffe7fe977392be5e5"
  "ec1548cfb63b04c5381ce5a27f46db50"
)

package() {
  pex -v \
    --inherit-path=fallback \
    "ebookmeta" "darkdetect" "show-in-file-manager" \
    -D "$pkgname-$pkgver/src/python/libro2" \
    --python=python --sh-boot \
    --exe="$pkgname-$pkgver/src/python/libro2/main.py" \
    -o "$pkgname-$pkgver.pex"

  install -Dm a+rx "$pkgname-$pkgver.pex" "$pkgdir/usr/bin/libro2"
  install -D "libro2.desktop" "$pkgdir/usr/share/applications/libro2.desktop"
  install -D "$pkgname-$pkgver/linux/libro2.png" "$pkgdir/usr/share/icons/libro2.png"
}
